generator client {
  provider = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
     extensions = [vector]
}

model User {
  id            String   @id @default(uuid())
  walletAddress String   @unique @map("wallet_address")
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  agents        Agent[]
}

model Agent {
  id         String        @id @default(uuid())
  name       String        @unique
  objective  String
  topics     String[]
  style      Json
  adjectives String[]
  owner      User          @relation(fields: [ownerId], references: [id])
  createdAt  DateTime      @default(now())
  updatedAt  DateTime      @updatedAt
  memories   AgentMemory[]
  ownerId    String
  isActive   Boolean       @default(false)
}

model AgentMemory {
  id        String                @id @default(uuid())
  agentId   String
  type      MemoryType
  content   String
  embedding Float[] 
  metadata  Json?
  createdAt DateTime              @default(now())
  updatedAt DateTime              @updatedAt
  agent       Agent                 @relation(fields: [agentId], references: [id])

  @@index([agentId, type])
  @@unique([agentId, type, content]) 
}

enum MemoryType {
  BIO
  LORE
  POST_EXAMPLE
  GENERATED_RESPONSE
}
